import { Storage } from '../utils/storage.js';
import { Currency } from '../utils/currency.js';

export class InvoiceManager {
    constructor() {
        this.container = null;
        this.products = [];
    }

    init(container) {
        this.container = container;
        this.products = Storage.getProducts();
        this.render();
        this.setupEventListeners();
        this.loadData();
    }

    render() {
        this.container.innerHTML = `
            <div id="invoice" class="page">
                <h2 class="mb-4">الفواتير</h2>
                
                <ul class="nav nav-tabs mb-4">
                    <li class="nav-item">
                        <a class="nav-link active" href="#" data-tab="new-invoice">فاتورة جديدة</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#" data-tab="manage-invoices">إدارة الفواتير</a>
                    </li>
                </ul>
                
                <!-- محتوى التبويبات -->
                <div id="new-invoice" class="invoice-tab active">
                    <!-- نموذج الفاتورة -->
                </div>
                
                <div id="manage-invoices" class="invoice-tab">
                    <div class="table-responsive">
                        <table class="table" id="invoices-table">
                            <!-- جدول الفواتير -->
                        </table>
                    </div>
                </div>
            </div>
        `;
    }

    loadData() {
        // تحميل البيانات
    }

    setupEventListeners() {
        // إعداد الأحداث
    }

    generateInvoiceNumber() {
        const invoices = Storage.getInvoices();
        return "INV-" + new Date().getFullYear() + "-" + 
               (invoices.length + 1).toString().padStart(4, '0');
    }

    saveInvoice(invoiceData) {
        const invoices = Storage.getInvoices();
        invoices.push(invoiceData);
        Storage.setInvoices(invoices);
    }
}
import { Storage } from '../utils/storage.js';
import { Currency } from '../utils/currency.js';

export class ProductCostManager {
    constructor() {
        this.container = null;
    }

    init(container) {
        this.container = container;
        this.render();
        this.setupEventListeners();
    }

    render() {
        this.container.innerHTML = `
            <div id="product-cost" class="page">
                <h2 class="mb-4">حساب تكلفة المنتج</h2>
                
                <div class="product-info-section">
                    <h5>معلومات المنتج</h5>
                    <div class="row">
                        <div class="col-md-4">
                            <div class="mb-3">
                                <label class="form-label">اسم المنتج</label>
                                <input type="text" class="form-control" id="product-name" required>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="mb-3">
                                <label class="form-label">رمز المنتج</label>
                                <input type="text" class="form-control" id="product-code" readonly>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- بقية النموذج -->
            </div>
        `;
    }

    setupEventListeners() {
        // إعداد الأحداث
    }

    generateProductCode() {
        const products = Storage.getProducts();
        return "PRD-" + (products.length + 1).toString().padStart(4, '0');
    }

    saveProduct(productData) {
        const products = Storage.getProducts();
        products.push(productData);
        Storage.setProducts(products);
    }
}
import { Storage } from '../utils/storage.js';
import { CONFIG } from '../config.js';

export class SettingsManager {
    constructor() {
        this.container = null;
    }

    init(container) {
        this.container = container;
        this.render();
        this.loadSettings();
        this.setupEventListeners();
    }

    render() {
        this.container.innerHTML = `
            <div id="settings" class="page">
                <h2 class="mb-4">الإعدادات</h2>
                
                <!-- قسم تفاصيل المشروع -->
                <div class="settings-section">
                    <h4><i class="bi bi-building"></i> تفاصيل المشروع</h4>
                    <form id="project-settings-form">
                        <!-- نموذج الإعدادات -->
                    </form>
                </div>
                
                <!-- بقية الأقسام -->
            </div>
        `;
    }

    loadSettings() {
        const settings = Storage.getSettings();
        // تحميل الإعدادات في النموذج
    }

    saveSettings(settings) {
        Storage.setSettings(settings);
    }
}
import { CONFIG } from '../config.js';

export const Currency = {
    format(amount, currency = 'BHD') {
        const config = CONFIG.CURRENCIES[currency];
        return `${amount.toFixed(3)} ${config.symbol}`;
    },

    getSymbol(currency = 'BHD') {
        return CONFIG.CURRENCIES[currency]?.symbol || 'د.ب';
    }
};
import { CONFIG } from '../config.js';

export const Storage = {
    get(key) {
        const data = localStorage.getItem(key);
        return data ? JSON.parse(data) : null;
    },

    set(key, value) {
        localStorage.setItem(key, JSON.stringify(value));
    },

    remove(key) {
        localStorage.removeItem(key);
    },

    getProducts() {
        return this.get(CONFIG.STORAGE_KEYS.PRODUCTS) || [];
    },

    setProducts(products) {
        this.set(CONFIG.STORAGE_KEYS.PRODUCTS, products);
    },

    getInvoices() {
        return this.get(CONFIG.STORAGE_KEYS.INVOICES) || [];
    },

    setInvoices(invoices) {
        this.set(CONFIG.STORAGE_KEYS.INVOICES, invoices);
    },

    getSettings() {
        return this.get(CONFIG.STORAGE_KEYS.SETTINGS) || {};
    },

    setSettings(settings) {
        this.set(CONFIG.STORAGE_KEYS.SETTINGS, settings);
    }
};
export const Validation = {
    isValidEmail(email) {
        const re = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
        return re.test(email);
    },

    isValidPhone(phone) {
        const re = /^[0-9+\-\s()]+$/;
        return re.test(phone);
    },

    showError(input, message) {
        input.classList.add('is-invalid');
        const feedback = input.parentElement.querySelector('.invalid-feedback');
        if (feedback) {
            feedback.textContent = message;
        }
    },

    clearError(input) {
        input.classList.remove('is-invalid');
    }
};
#dashboard .summary-container {
    display: flex;
    flex-wrap: nowrap;
    overflow-x: auto;
    gap: 15px;
    padding: 10px 0;
}

#dashboard .summary-box {
    min-width: 200px;
    background-color: white;
    border-radius: 8px;
    padding: 15px;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    border-left: 4px solid #3498db;
}
.invoice-tab {
    display: none;
}

.invoice-tab.active {
    display: block;
}

.invoice-container {
    background-color: white;
    border-radius: 10px;
    box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
    padding: 20px;
    margin: 20px auto;
    max-width: 800px;
}

.invoice-table {
    width: 100%;
    border-collapse: collapse;
}

.tax-related {
    display: none;
}
:root {
    --primary-color: #2c3e50;
    --secondary-color: #34495e;
    --success-color: #27ae60;
    --danger-color: #e74c3c;
}

body {
    font-family: 'Arial', sans-serif;
    background-color: #f5f5f5;
}

.sidebar {
    background-color: var(--primary-color);
    min-height: 100vh;
    color: white;
}

.sidebar .nav-link {
    color: rgba(255, 255, 255, 0.8);
    margin-bottom: 5px;
}

.sidebar .nav-link:hover,
.sidebar .nav-link.active {
    color: white;
    background-color: var(--secondary-color);
}

.page {
    display: none;
}

.page.active {
    display: block;
}

.card {
    border-radius: 10px;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    margin-bottom: 20px;
}

/* ... أنماط مشتركة أخرى ... */
#products .table-responsive {
    margin-top: 20px;
}

#products .product-info-section {
    background-color: #f8f9fa;
    padding: 15px;
    border-radius: 8px;
    margin-bottom: 20px;
}
.settings-section {
    background-color: white;
    border-radius: 10px;
    padding: 20px;
    margin-bottom: 20px;
    box-shadow: 0 2px 5px rgba(0,0,0,0.1);
}

.color-option {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    display: inline-block;
    margin: 5px;
    cursor: pointer;
    border: 2px solid transparent;
}

.color-option.selected {
    border-color: #000;
}
[
    {
        "number": "INV-2024-0001",
        "customerName": "عميل تجريبي",
        "customerPhone": "+97312345678",
        "date": "2024-01-01",
        "items": [],
        "total": 50.0,
        "status": "paid"
    }
]
[
    {
        "id": "PRD-0001",
        "name": "منتج تجريبي 1",
        "piecesPerBox": 10,
        "materialsCost": 5.5,
        "packagingCost": 2.3,
        "laborCost": 1.2,
        "depreciation": 0.5,
        "profitRate": 20,
        "finalPrice": 11.4
    }
]
<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>برنامج الحسابات المتكامل</title>

    <!-- Bootstrap & Icons -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">

    <!-- CSS Files -->
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/dashboard.css">
    <link rel="stylesheet" href="css/invoice.css">
    <link rel="stylesheet" href="css/products.css">
    <link rel="stylesheet" href="css/settings.css">
</head>
<body>
    <div class="container-fluid">
        <div class="row">
            <!-- Sidebar -->
            <div class="col-md-2 sidebar p-0">
                <div class="p-3">
                    <h4 class="text-center" id="project-name-sidebar">برنامج الحسابات</h4>
                    <hr>
                    <ul class="nav flex-column">
                        <li class="nav-item">
                            <a class="nav-link active" href="#" data-page="dashboard">
                                <i class="bi bi-speedometer2"></i> لوحة التحكم
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#" data-page="invoice">
                                <i class="bi bi-receipt"></i> الفواتير
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#" data-page="products">
                                <i class="bi bi-box-seam"></i> المنتجات
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#" data-page="product-cost">
                                <i class="bi bi-calculator"></i> تكلفة المنتج
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#" data-page="settings">
                                <i class="bi bi-gear"></i> الإعدادات
                            </a>
                        </li>
                    </ul>
                </div>
            </div>

            <!-- Main Content -->
            <div class="col-md-10 main-content p-4">
                <div id="dashboard" class="page active">Loading...</div>
                <div id="invoice" class="page">Loading...</div>
                <div id="products" class="page">Loading...</div>
                <div id="product-cost" class="page">Loading...</div>
                <div id="settings" class="page">Loading...</div>
            </div>
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

    <!-- Main Application -->
    <script type="module" src="js/app.js"></script>
</body>
</html>
import { DashboardManager } from './modules/dashboard.js';
import { InvoiceManager }     from './modules/invoice.js';
import { ProductCostManager } from './modules/product-cost.js';
import { SettingsManager }    from './modules/settings.js';
import { Storage }            from './utils/storage.js';

class App {
    constructor() {
        this.modules = {
            dashboard:  new DashboardManager(),
            invoice:    new InvoiceManager(),
            products:   null,                // سيتم إضافته لاحقاً
            'product-cost': new ProductCostManager(),
            settings:   new SettingsManager()
        };
        this.currentPage = 'dashboard';
    }

    init() {
        this.setupNavigation();
        this.loadPage(this.currentPage);
    }

    setupNavigation() {
        document.querySelectorAll('[data-page]').forEach(link => {
            link.addEventListener('click', (e) => {
                e.preventDefault();
                const pageId = link.getAttribute('data-page');
                this.loadPage(pageId);

                // تبديل النشاط في القائمة الجانبية
                document.querySelectorAll('.sidebar .nav-link')
                        .forEach(l => l.classList.remove('active'));
                link.classList.add('active');
            });
        });
    }

    loadPage(pageId) {
        this.currentPage = pageId;
        const container = document.getElementById(pageId);
        if (!container) return;

        // إخفاء جميع الصفحات
        document.querySelectorAll('.page')
                .forEach(p => p.classList.remove('active'));

        // إظهار الصفحة المطلوبة
        container.classList.add('active');

        // تهيئة الوحدة المناسبة
        if (this.modules[pageId]) {
            this.modules[pageId].init(container);
        }
    }
}

document.addEventListener('DOMContentLoaded', () => new App().init());
export const CONFIG = {
    API_BASE_URL: './data/',
    CURRENCIES: {
        'BHD': { symbol: 'د.ب', name: 'دينار بحريني' },
        'SAR': { symbol: 'ر.س', name: 'ريال سعودي' },
        'AED': { symbol: 'د.إ', name: 'درهم إماراتي' },
        'QAR': { symbol: 'ر.ق', name: 'ريال قطري' },
        'KWD': { symbol: 'د.ك', name: 'دينار كويتي' },
        'OMR': { symbol: 'ر.ع', name: 'ريال عماني' },
        'USD': { symbol: '$', name: 'دولار أمريكي' }
    },
    TAX_RATE: 0.1,
    STORAGE_KEYS: {
        PRODUCTS: 'accounting_products',
        INVOICES: 'accounting_invoices',
        SETTINGS: 'accounting_settings'
    }
};
import { Storage } from '../utils/storage.js';
import { Currency } from '../utils/currency.js';

export class DashboardManager {
    constructor() {
        this.container = null;
    }

    init(container) {
        this.container = container;
        this.render();
        this.loadData();
    }

    render() {
        this.container.innerHTML = `
            <div id="dashboard" class="page active">
                <h2 class="mb-4">لوحة التحكم</h2>
                <div class="summary-container">
                    <div class="summary-box">
                        <div class="summary-title">إجمالي المنتجات</div>
                        <div class="summary-value" id="total-products">0</div>
                    </div>
                    <div class="summary-box">
                        <div class="summary-title">إجمالي الفواتير</div>
                        <div class="summary-value" id="total-invoices">0</div>
                    </div>
                    <div class="summary-box">
                        <div class="summary-title">الإيرادات الكلية</div>
                        <div class="summary-value" id="total-revenue">0.000 د.ب</div>
                    </div>
                </div>
                <div class="alert alert-info mt-4">صفحة لوحة التحكم - تحت التطوير</div>
            </div>
        `;
    }

    loadData() {
        const products = Storage.getProducts();
        const invoices = Storage.getInvoices();
        
        document.getElementById('total-products').textContent = products.length;
        document.getElementById('total-invoices').textContent = invoices.length;
        
        const totalRevenue = invoices.reduce((sum, inv) => sum + (inv.total || 0), 0);
        document.getElementById('total-revenue').textContent = Currency.format(totalRevenue);
    }
}
